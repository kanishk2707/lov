<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Will you marry me?</title>
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    html,body,#root{height:100%}
    body{
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
      background: linear-gradient(180deg,#020617 0%, #081426 55%, #0b1b25 100%);
      color:#fff; display:flex; align-items:center; justify-content:center; overflow:hidden;
    }

    .app {
      width:920px; max-width:96vw; height:640px; max-height:92vh;
      border-radius:18px; overflow:hidden; position:relative;
      box-shadow:0 20px 50px rgba(2,6,23,0.6);
      border:1px solid rgba(255,255,255,0.03);
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    }

    /* Canvas fills the container */
    .bg-canvas { position:absolute; inset:0; z-index:1; display:block; }

    .card{
      position:absolute; z-index:6; left:50%; top:50%; transform:translate(-50%,-50%);
      width:min(700px,92%); padding:34px; border-radius:14px;
      background: linear-gradient(180deg, rgba(0,0,0,0.18), rgba(255,255,255,0.02));
      border:1px solid rgba(255,255,255,0.03);
      box-shadow:0 12px 40px rgba(3,12,22,0.55); text-align:center;
    }

    .question{ font-size:34px; color:#f2fcff; margin-bottom:20px; line-height:1.1; }

    .buttons { position:relative; height:110px; display:flex; align-items:center; justify-content:center; }

    .btn{
      user-select:none; padding:14px 28px; font-size:18px; border-radius:12px; border:none;
      cursor:pointer; transition: transform 160ms cubic-bezier(.2,.9,.2,1), box-shadow 160ms;
      min-width:140px; font-weight:700;
    }
    .btn-yes{
      position:relative;
      background: linear-gradient(180deg, rgba(0,230,255,0.14), rgba(0,205,255,0.06));
      color:#eaffff; border:1px solid rgba(0,230,255,0.12);
      box-shadow:0 12px 30px rgba(0,200,255,0.06), inset 0 -2px 0 rgba(255,255,255,0.03);
      z-index:7;
    }
    .btn-no{
      position:absolute; left:50%; top:50%; transform:translate(-50%,-50%);
      background: linear-gradient(180deg, rgba(255,90,125,0.06), rgba(255,90,125,0.03));
      color:#ffdce3; border:1px solid rgba(255,90,125,0.06);
      box-shadow:0 12px 30px rgba(255,80,120,0.03);
      touch-action: manipulation;
    }

    .success{
      position:absolute; inset:0; z-index:9; display:flex; align-items:center; justify-content:center;
      flex-direction:column; gap:12px; background: linear-gradient(180deg, rgba(0,0,0,0.28), rgba(0,0,0,0.46));
      color:#fff; text-align:center; padding:20px; font-size:18px;
    }
    .success h1{ font-size:44px; color:#fff8ea; letter-spacing:1px; }

    @media (max-width:520px){
      .card{ padding:18px; border-radius:12px }
      .question{ font-size:22px }
      .buttons{ height:140px }
      .btn{ font-size:16px; min-width:120px; padding:12px 18px }
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <!-- UMD React + ReactDOM (reliable UMD bundles) -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

  <script>
  (function () {
    const React = window.React;
    const ReactDOM = window.ReactDOM;
    const { useRef, useEffect, useState } = React;

    /* Canvas background: draws animated light rays (simple, performant) */
    function useLightCanvas(canvasRef, opts = {}) {
      useEffect(() => {
        const canvas = canvasRef.current;
        if (!canvas) return;
        const ctx = canvas.getContext('2d', { alpha: true });
        let raf = null;
        const DPR = Math.min(window.devicePixelRatio || 1, 2);

        function resize() {
          const rect = canvas.getBoundingClientRect();
          canvas.width = Math.max(1, Math.floor(rect.width * DPR));
          canvas.height = Math.max(1, Math.floor(rect.height * DPR));
        }

        // Simple animated rays: draw blurred gradient + moving streaks
        let t0 = performance.now();
        function frame(now) {
          const t = (now - t0) * 0.001;
          const w = canvas.width, h = canvas.height;
          ctx.clearRect(0,0,w,h);

          // base glow gradient
          const g = ctx.createLinearGradient(0, 0, 0, h);
          g.addColorStop(0, 'rgba(0,255,255,0.12)');
          g.addColorStop(0.25, 'rgba(0,200,255,0.06)');
          g.addColorStop(1, 'rgba(0,0,0,0.00)');
          ctx.fillStyle = g;
          ctx.fillRect(0, 0, w, h);

          // moving streaks
          ctx.globalCompositeOperation = 'lighter';
          for (let i = 0; i < 3; i++) {
            const offset = t * (0.25 + i * 0.18);
            const alpha = 0.08 + i * 0.05;
            drawStreak(ctx, w, h, offset, alpha, i);
          }
          ctx.globalCompositeOperation = 'source-over';

          raf = requestAnimationFrame(frame);
        }

        function drawStreak(ctx, w, h, offset, alpha, idx) {
          ctx.save();
          ctx.translate(w / 2, -h * 0.15 + idx * 30);
          ctx.rotate((Math.sin(offset * 0.6 + idx) * 6) * Math.PI / 180);
          // gradient for streak
          const grad = ctx.createLinearGradient(-w*0.6, 0, w*0.6, 0);
          grad.addColorStop(0, `rgba(0,255,255,${0 * alpha})`);
          grad.addColorStop(0.3, `rgba(0,255,255,${0.12 * alpha})`);
          grad.addColorStop(0.5, `rgba(0,200,255,${0.26 * alpha})`);
          grad.addColorStop(1, `rgba(0,255,255,${0.06 * alpha})`);
          ctx.fillStyle = grad;

          // draw skewed rectangle as streak with blur effect (using shadow)
          ctx.shadowColor = 'rgba(0,255,255,0.8)';
          ctx.shadowBlur = 40 + idx * 12;
          ctx.fillRect(-w * 0.9 + (Math.sin(offset + idx) * w * 0.2), 0, w * 1.8, h * 0.2);
          ctx.restore();
        }

        function onResize() {
          resize();
        }

        window.addEventListener('resize', onResize);
        resize();
        raf = requestAnimationFrame(frame);

        return () => {
          window.removeEventListener('resize', onResize);
          if (raf) cancelAnimationFrame(raf);
        };
      }, [canvasRef]);
    }

    /* Main React app */
    function App() {
      const canvasRef = useRef(null);
      useLightCanvas(canvasRef);

      const containerRef = useRef(null);
      const noRef = useRef(null);
      const yesRef = useRef(null);
      const [accepted, setAccepted] = useState(false);

      const TRIGGER_DISTANCE = 130;

      // initial placement
      useEffect(() => {
        const no = noRef.current;
        if (!no) return;
        no.style.position = 'absolute';
        placeNoRandom();
      }, []);

      // proximity detection
      useEffect(() => {
        function updatePointer(e) {
          const pointerX = (e.clientX ?? (e.touches && e.touches[0] && e.touches[0].clientX)) || -9999;
          const pointerY = (e.clientY ?? (e.touches && e.touches[0] && e.touches[0].clientY)) || -9999;
          const no = noRef.current;
          if (!no) return;
          const nb = no.getBoundingClientRect();
          const nbC = { x: nb.left + nb.width/2, y: nb.top + nb.height/2 };
          const dist = Math.hypot(nbC.x - pointerX, nbC.y - pointerY);
          if (dist < TRIGGER_DISTANCE) placeNoRandom();
        }

        window.addEventListener('mousemove', updatePointer, { passive: true });
        window.addEventListener('touchmove', updatePointer, { passive: true });
        return () => {
          window.removeEventListener('mousemove', updatePointer);
          window.removeEventListener('touchmove', updatePointer);
        };
      }, []);

      // No button touch/click handling
      useEffect(() => {
        const no = noRef.current;
        if (!no) return;

        const onTouch = (e) => { e.preventDefault(); placeNoRandom(); };
        const onPointer = (e) => { placeNoRandom(); };
        const onClick = (e) => { e.preventDefault(); placeNoRandom(); };

        no.addEventListener('touchstart', onTouch, { passive: false });
        no.addEventListener('pointerdown', onPointer, { passive: true });
        no.addEventListener('click', onClick);

        return () => {
          no.removeEventListener('touchstart', onTouch);
          no.removeEventListener('pointerdown', onPointer);
          no.removeEventListener('click', onClick);
        };
      }, []);

      function placeNoRandom() {
        const container = containerRef.current;
        const no = noRef.current;
        if (!container || !no) return;
        const inner = container.querySelector('.card');
        const buttons = inner.querySelector('.buttons');
        const area = buttons.getBoundingClientRect();
        const btn = no.getBoundingClientRect();

        const padding = 6;
        const maxLeft = Math.max(padding, area.width - btn.width - padding);
        const maxTop = Math.max(padding, area.height - btn.height - padding);

        const left = Math.floor(Math.random() * maxLeft);
        const top = Math.floor(Math.random() * maxTop);

        // position relative to buttons container
        // compute buttons' left/top to set absolute coords relative to it
        const relLeft = left;
        const relTop = top;

        no.style.left = relLeft + 'px';
        no.style.top = relTop + 'px';

        // tiny animation
        if (no.animate) {
          no.animate([{ transform: 'translateY(-6px) scale(0.96)' }, { transform: 'translateY(0) scale(1)' }], { duration: 200, easing: 'cubic-bezier(.2,.9,.2,1)' });
        }
      }

      function handleYes() { setAccepted(true); }

      return React.createElement('div', { className: 'app', ref: containerRef },
        React.createElement('canvas', { ref: canvasRef, className: 'bg-canvas', style: { width: '100%', height: '100%' } }),
        React.createElement('div', { className: 'card' },
          React.createElement('div', { className: 'question' }, 'will you marry me'),
          React.createElement('div', { className: 'buttons' },
            React.createElement('button', { ref: yesRef, className: 'btn btn-yes', onClick: handleYes, style: { position: 'relative' } }, 'Yes'),
            React.createElement('button', { ref: noRef, className: 'btn btn-no', 'aria-label': 'No' }, 'No')
          )
        ),
        accepted && React.createElement('div', { className: 'success' },
          React.createElement('h1', null, 'yassssss we  marryyyyy'),
          React.createElement('p', null, 'so happy!')
        )
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(React.createElement(App));
  })();
  </script>
</body>
</html>
